{% extends "layout.html" %}
{% block body %}

{% for twiit in twiits %}
<div class="panel panel-default">
  <div class="panel-body">
    {% if twiit.user_id == g.user.id %}
    <div class="dropdown pull-right">
      <button class="btn btn-default btn-twiit-menu dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        <span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
        <li><a href="#" class="edit-twiit-button" data-id="{{ twiit.id }}">Edit Twiit</a></li>
        <li><a href="#" class="delete-twiit-button" data-id="{{ twiit.id }}">Delete Twiit</a></li>
      </ul>
    </div>
    {% endif %}
    <div class="media">
      <div class="media-left">
        <img class="media-object" src="{{ twiit.user.picture }}" height="64" width="64">
      </div>
      <div class="media-body">
        <h4 class="media-heading">{{ twiit.user.name }}</h4>
        <p class="twiit-handle">{{ twiit.user.email }} &bull;
          {% if twiit.updated_at %} edited {% endif %}
          <span class="twiit-timestamp" data-timestamp="{{ twiit.updated_at or twiit.created_at }}"></span>
        </p>
        <div class="twiit-content">{{ twiit.text|linebreaks }}</div>
        {% if twiit.image_url %}
        <img src="{{ twiit.image_url }}">
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endfor %}

<!-- Delete Modal -->
<div class="modal fade" id="deleteTwiitModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title text-center modal-dialog-header">Are you sure you want to delete this Twiit?</h4>
      </div>
      <div class="modal-body">
        <div class="media">
          <div class="media-left">
            <img class="media-object" src="{{ g.user.picture}}" height="64" width="64">
          </div>
          <div class="media-body">
            <h4 class="media-heading">{{ g.user.name }}</h4>
            <p class="twiit-handle">{{ g.user.email }} &bull; <span id="delete-twiit-timestamp" class="twiit-timestamp"></span></p>
            <div id="delete-twiit-content" class="twiit-content">Placeholder Content</div>
            <img id="delete-twiit-img" style="display: none;" src="http://placehold.it/350x150">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" id="confirm-delete-button" class="btn btn-primary">Delete</button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal fade" id="editTwiitModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title text-center modal-dialog-header">Edit Twiit</h4>
      </div>
      <div class="modal-body">
        <div class="media">
          <div class="media-left">
            <img class="media-object" src="{{ g.user.picture}}" height="64" width="64">
          </div>
          <div class="media-body">
            <h4 class="media-heading">{{ g.user.name }}</h4>
            <p class="twiit-handle">{{ g.user.email }} &bull; <span id="edit-twiit-timestamp" class="twiit-timestamp"></span></p>
            <form id="edit-twiit-form">
            <textarea id="edit-twiit-content" class="form-control twiit-input" name="text" rows="5"></textarea>
            </form>
            <img id="edit-twiit-img" class="img-preview center-block" style="display: none;">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" id="confirm-edit-button" class="btn btn-primary">Confirm Edit</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}
